# DisplaySwitchVNC
A helper application to make life easier when connecting from a single monitor VNC Viewer computer to a multi monitor VNC Server. This was developed for use with [VNC Connect](https://www.realvnc.com/en/connect/) by RealVNC.

This is an unofficial application and is not developed or supported by RealVNC.

## How do I download it?
Downloads for DisplaySwitchVNC are found under [Releases](https://github.com/jackyaz/DisplaySwitchVNC/releases)

## How do I use it?
DisplaySwitchVNC will run automatically on startup, in the background. It will appear automatically when you connect using VNC Viewer. You can view the User Application at any time, either via the desktop shortcut, or double clicking the system tray icon.

## Which versions and operating systems are supported?
This application only needs to be installed on the device running [VNC Server](https://www.realvnc.com/en/connect/download/vnc/windows/) - any [VNC Viewer](https://www.realvnc.com/en/connect/download/viewer/) (RealVNC) can be used.
* VNC Server- this has been tested on VNC Server (RealVNC) on version 6.2.0 and above
* Operating system - this was developed and tested on Windows 10, but should run on the Windows versions supported by VNC Connect (Windows 7 and later)

## What does it do?
This application was created out of the need to view a single monitor at a time when connecting to my gaming desktop with VNC Connect. My gaming desktop has 3 monitors attached (was 4!), and I would often remotely connect to it using VNC Viewer from my Android phone. The current (as at 2019-01-16) version of VNC Connect does not feature the ability to easily switch between monitors.

This is where DisplaySwitchVNC comes in! I developed this application to run on my computer, which would provide an easy way to select which monitor I would see from my Android device (or in fact, any device with VNC Viewer). To do this, I leveraged an existing parameter of VNC Server [DisplayDevice](https://www.realvnc.com/en/connect/docs/server-parameter-ref.html#server-displaydevice). DisplaySwitchVNC enumerates the connected monitors, sorts them by top-to-bottom, left-to-right (as reported by Windows), and provides a simple UI to select a monitor and feed the required value to the DisplayDevice parameter.

There are 2 components to DisplaySwitchVNC - a Windows Service, and a user application. 
### Windows Service
This is responsible for writing the configuration changes to VNC Server, as well as tracking logon, logoff, lock and unlock events. DisplaySwitchVNC will cleverly swap to show the primary monitor when on the lock screen, so that you do not inadvertently lock yourself out your PC! The service will also watch for VNC connections, and use these to show/hide the User Application, as required. This is achieved by watching the Event Log, which VNC Server writes to by default.

### User Application
This allows the user to pick the display they want to see. It will "follow" the user between screens as they select them. By "closing" the main UI, it will be shrunk to a small button, to minimise the screen real estate lost. The User Application cannot be easily closed, to prevent getting "stuck" viewing a particular monitor. It can always be closed via the system tray icon, or Task Manager.

## Credits
### ExeMsiCombiner
This tool/code was sourced from [here](http://epav.co.uk/giles/)
It is used to combine the EXE and MSI files generated by the Visual Studio Setup Project
